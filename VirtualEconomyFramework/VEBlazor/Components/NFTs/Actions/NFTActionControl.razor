@inherits NFTComponentBase;
@inject AppData AppData

<Card Margin="Margin.Is4.FromBottom">
    <CardBody>
        <CardTitle Size="5">Actions</CardTitle>
        @if (!HideOpenInWorkTabButton)
        {                                
        <Row>
            <Column>
                <Button Color="Color.Primary" Clicked=@OpenNFTInWorkTab Block>
                    <Icon Name="IconName.FolderOpen" />
                    Open In Work Tab
                </Button>
            </Column>
        </Row>
        }
        @if (IsOwnNFT && AppData.IsAccountLoaded) 
        { 
            <Row Margin="Margin.Is3.FromTop"> 
                <Column> 
                    <Button Color="Color.Primary" Clicked=@SendNFT Block> 
                        <Icon Name="IconName.Mail" /> 
                        Send 
                    </Button> 
                </Column> 
                <Column> 
                    <Button Color="Color.Danger" Clicked=@DestroyNFT Block> 
                        <Icon Name="IconName.Delete" /> 
                        Destroy 
                    </Button> 
                </Column> 
            </Row> 
        } 
    </CardBody>
</Card>

<DestroyNFT @ref=DestroyNFTModalComponent
            NFT="@NFT"
            Address="@Address"
            IsSubAccount="@IsSubAccount"
            NFTSent="NFTDestroyedHandler" />
            
<SendNFT @ref=SendNFTModalComponent
         NFT="@NFT"
         Address="@Address"
         IsSubAccount="@IsSubAccount"
         NFTSent="NFTSendHandler" />

         
@code {

    private DestroyNFT? DestroyNFTModalComponent;
    private SendNFT? SendNFTModalComponent;

    void SendNFT()
    {
        if ( NFT == null )
            return;
        SendNFTModalComponent?.ShowSendNFTModal();
    }

    void DestroyNFT()
    {
        if ( NFT == null )
            return;
        DestroyNFTModalComponent?.ShowDestroyNFTModal();
    }
    public async Task NFTSendHandler( NFTSentResultDto e )
    {
        SendNFTModalComponent?.HideSendNFTModal();
        await NFTSent.InvokeAsync( e );
    }
    public async Task NFTDestroyedHandler( NFTSentResultDto e )
    {
        DestroyNFTModalComponent?.HideDestroyNFTModal();
        await NFTSent.InvokeAsync( e );
    }
}
